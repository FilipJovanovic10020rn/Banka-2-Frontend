<div class="body-container">

  <p-breadcrumb [model]="breadcrumbItems"></p-breadcrumb>

  <div class="table-container">
    <p-table [value]="stocks" #dt class="p-datatable-header"
             [rowHover]="true" [rows]="6" [showCurrentPageReport]="true"
             [paginator]="true" [alwaysShowPaginator]="false"
             [loading]="loading" [loadingIcon]="''" styleClass="dark-panel"
             currentPageReportTemplate="Prikazani su {first}-{last} od ukupno {totalRecords} hartija"
             [filterDelay]="10" [globalFilterFields]="['firstName','lastName','email','jobPosition','jmbg']">
      <ng-template pTemplate="caption">

        <div class="table-header row">
          <div class="col-4 text-start table-name">
            <h3 style="font-size: medium;">
              Berza
            </h3>
            <button (click)="promeniOpciju()">Promeni opciju</button>
          </div>
        </div>
      </ng-template>
      
      <ng-template pTemplate="header" >
        <tr>
          <th pSortableColumn="ticker" style="width: 2rem;  font-size: 12px;">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Oznaka</p>
                <p-sortIcon field="ticker"></p-sortIcon>
              </div>
            </div>
          </th>
          <th pSortableColumn="price" style="width: 2rem; font-size: 12px;">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Cena</p>
                <p-sortIcon field="price"></p-sortIcon>
              </div>
            </div>
          </th>
          <th pSortableColumn="volume" style="width: 3rem; font-size: 12px; ">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Volume</p>
                <p-sortIcon field="volume"></p-sortIcon>
              </div>
            </div>
          </th>
          <th pSortableColumn="change" style="width: 3rem; font-size: 12px; ">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Promena</p>
                <p-sortIcon field="change"></p-sortIcon>
              </div>
            </div>
          </th>
          <th style="width: 12rem; font-size: 12px; ">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Promena u procentima</p>
              </div>
            </div>
          </th>
          <th pSortableColumn="lastRefresh" style="width: 40rem; font-size: 12px; ">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Poslednje a≈æuriranje</p>
                <p-sortIcon field="lastRefresh"></p-sortIcon>
              </div>
            </div>
          </th>
          <th style="font-size: 12px; ">
            <div class="flex justify-content-between align-items-center">
              <div class="icon-container">
                <p style="margin-bottom: 0; margin-top: 2px;">Opcije</p>
              </div>
            </div>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="loadingbody">
        <tr>
           <td><p-skeleton width="3rem"></p-skeleton></td>
           <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
           <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
           <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
           <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
           <td><p-skeleton styleClass="mb-2"></p-skeleton></td>
           <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
        </tr>
        <tr>
          <td><p-skeleton width="3rem"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
        </tr>
        <tr>
          <td><p-skeleton width="3rem"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="4rem" styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton styleClass="mb-2"></p-skeleton></td>
          <td><p-skeleton width="3rem" styleClass="mb-2"></p-skeleton></td>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-stock>
        <tr class="rowHover" (click)="openMoreInfoDialog(stock)" style="font-size: 12px;">
          <td>{{stock.ticker}}</td>
          <td>{{stock.price}}</td>
          <td>
            <span class="p-column-title">firstName</span>
            <span>{{stock.volume}}</span>
          </td>
          <td [ngStyle]="{'color': stock.change >0? 'green' : 'red'}">
            <span class="p-column-title">change</span>
            <div>            
              <strong>
                <i [ngClass]="stock.change >0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down' ">

                </i> 
                {{stock.change}}
              </strong>
            </div>
          </td>
          <!-- <td>{{user.last_name}}</td> -->
          <td [ngStyle]="{'color': stock.change >0? 'green' : 'red'}" >
            <span class="p-column-title">changePCT</span>
            <div>            
              <strong>
                <i [ngClass]="stock.change >0 ? 'pi pi-arrow-up' : 'pi pi-arrow-down' ">
                  
                </i> 
                {{stock.change | changePerc}}
              </strong>
            </div>
          </td>
          <td>
            <span class="p-column-title">jobPosition</span>
            <span>{{stock.lastRefresh}}</span>
          </td>
          <td>
            <button *ngIf="BuySellOption" (click)="kupiPopUp($event,stock)">Kupi</button>
            <button *ngIf="!BuySellOption" (click)="prodajPopUp($event,stock)">Prodaj</button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
<app-stock-details></app-stock-details>